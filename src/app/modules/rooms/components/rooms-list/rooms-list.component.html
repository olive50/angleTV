<div class="rooms-page">
  <!-- Header -->
  <div class="page-header">
    <div class="page-header-content">
      <h1 class="page-title">Room Management</h1>
      <p class="page-subtitle">Manage hotel rooms and their information</p>
    </div>
    <div class="page-actions">
      <div class="view-toggle">
        <button
          class="btn"
          [class.btn-primary]="viewMode === 'grid'"
          [class.btn-outline-primary]="viewMode !== 'grid'"
          (click)="setViewMode('grid')"
        >
          Grid
        </button>
        <button
          class="btn"
          [class.btn-primary]="viewMode === 'list'"
          [class.btn-outline-primary]="viewMode !== 'list'"
          (click)="setViewMode('list')"
        >
          List
        </button>
      </div>
      <button class="btn btn-secondary" (click)="exportRooms()">
        <i class="fas fa-download"></i>
        Export
      </button>
      <button class="btn btn-primary" (click)="addRoom()">
        <i class="fas fa-plus"></i>
        Add Room
      </button>
    </div>
  </div>

  <!-- Statistics -->
  <div class="stats-row" *ngIf="statistics">
    <div class="stat-card">
      <div class="stat-icon bg-primary">
        <i class="fas fa-bed"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ statistics.total }}</div>
        <div class="stat-label">Total Rooms</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon bg-success">
        <i class="fas fa-check-circle"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ statistics.available }}</div>
        <div class="stat-label">Available</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon bg-warning">
        <i class="fas fa-user"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ statistics.occupied }}</div>
        <div class="stat-label">Occupied</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon bg-info">
        <i class="fas fa-tools"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value">
          {{ (statistics.maintenance || 0) + (statistics.cleaning || 0) }}
        </div>
        <div class="stat-label">Maintenance</div>
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="filters-row">
      <div class="search-group">
        <div class="input-group">
          <span class="input-group-text">
            <i class="fas fa-search"></i>
          </span>
          <input
            type="text"
            class="form-control"
            placeholder="Search rooms..."
            [(ngModel)]="searchTerm"
            (input)="onSearch()"
          />
        </div>
      </div>

      <div class="filter-group">
        <select
          class="form-select"
          [(ngModel)]="statusFilter"
          (change)="onFilterChange()"
        >
          <option value="">All Statuses</option>
          <option *ngFor="let status of statuses" [value]="status.value">
            {{ status.label }}
          </option>
        </select>
      </div>

      <div class="filter-group">
        <select
          class="form-select"
          [(ngModel)]="typeFilter"
          (change)="onFilterChange()"
        >
          <option value="">All Types</option>
          <option *ngFor="let type of roomTypes" [value]="type.value">
            {{ type.label }}
          </option>
        </select>
      </div>

      <div class="filter-group">
        <select
          class="form-select"
          [(ngModel)]="buildingFilter"
          (change)="onFilterChange()"
        >
          <option value="">All Buildings</option>
          <option *ngFor="let building of buildings" [value]="building">
            {{ building }}
          </option>
        </select>
      </div>

      <div class="filter-actions">
        <button
          class="btn btn-outline-secondary"
          (click)="clearFilters()"
          *ngIf="hasActiveFilters()"
        >
          Clear
        </button>
      </div>
    </div>
  </div>

  <!-- Bulk Actions -->
  <div class="bulk-actions" *ngIf="selectedRooms.length > 0">
    <div class="bulk-info">
      <span>{{ selectedRooms.length }} room(s) selected</span>
    </div>
    <div class="bulk-buttons">
      <button class="btn btn-info btn-sm" (click)="bulkManageStatus()">
        <i class="fas fa-tasks"></i>
        Manage Status
      </button>
      <button class="btn btn-danger btn-sm" (click)="bulkDelete()">
        <i class="fas fa-trash"></i>
        Delete Selected
      </button>
    </div>
  </div>

  <!-- Loading -->
  <div class="loading-state" *ngIf="loading">
    <div class="spinner-border" role="status"></div>
    <p class="mt-3">Loading rooms...</p>
  </div>

  <!-- Error -->
  <div class="alert alert-danger" *ngIf="error">
    <i class="fas fa-exclamation-triangle me-2"></i>
    {{ error }}
    <button class="btn btn-outline-danger btn-sm ms-2" (click)="retryLoad()">
      Retry
    </button>
  </div>

  <!-- Content -->
  <div class="rooms-content" *ngIf="!loading && !error">
    <!-- Results Info Only -->
    <div class="results-info-row">
      <!-- <div class="results-info">
        {{ numberOfElements }} of {{ totalElements }} rooms
      </div> -->
      <div class="pagination-info">
        <small class="text-muted">
          Showing {{ numberOfElements }} rooms on page {{ currentPage + 1 }} of
          {{ totalPages }} ({{ totalElements }} total rooms)
        </small>
      </div>

      <!-- Grid View -->
      <div class="rooms-grid" *ngIf="viewMode === 'grid'">
        <div
          class="room-card"
          *ngFor="let room of rooms; trackBy: trackByRoomId"
        >
          <div class="room-card-header">
            <div class="room-number">{{ room.roomNumber }}</div>
            <span
              class="badge"
              [ngClass]="'badge-' + getStatusClass(room.status)"
            >
              {{ getStatusLabel(room.status) }}
            </span>
            <input
              type="checkbox"
              class="form-check-input"
              [checked]="isRoomSelected(room.id)"
              (change)="toggleRoomSelection(room.id)"
            />
          </div>

          <div class="room-card-body">
            <div class="room-type">{{ getRoomTypeLabel(room.roomType) }}</div>
            <div class="room-details">
              <div class="detail-item">
                <i class="fas fa-building"></i>
                <span>{{ room.building }}</span>
              </div>
              <div class="detail-item">
                <i class="fas fa-layer-group"></i>
                <span>Floor {{ room.floorNumber }}</span>
              </div>
              <div class="detail-item">
                <i class="fas fa-users"></i>
                <span>{{ room.capacity }} guests</span>
              </div>
              <div class="detail-item">
                <i class="fas fa-dollar-sign"></i>
                <span>{{ room.pricePerNight | currency }}</span>
              </div>
            </div>
          </div>

          <div class="room-card-actions">
            <button
              class="btn btn-sm btn-outline-primary"
              (click)="viewRoom(room.id)"
            >
              View
            </button>
            <button
              class="btn btn-sm btn-outline-secondary"
              (click)="editRoom(room.id)"
            >
              Edit
            </button>
            <button
              class="btn btn-sm btn-outline-danger"
              (click)="deleteRoom(room.id)"
            >
              Delete
            </button>
          </div>
        </div>
      </div>

      <!-- List View -->
      <div class="rooms-table" *ngIf="viewMode === 'list'">
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>
                  <input
                    type="checkbox"
                    class="form-check-input"
                    [checked]="allRoomsSelected()"
                    [indeterminate]="someRoomsSelected()"
                    (change)="toggleAllRoomsSelection()"
                  />
                </th>
                <th (click)="sort('roomNumber')" class="sortable">
                  Room Number
                  <i class="fas" [ngClass]="getSortIcon('roomNumber')"></i>
                </th>
                <th (click)="sort('roomType')" class="sortable">
                  Type
                  <i class="fas" [ngClass]="getSortIcon('roomType')"></i>
                </th>
                <th (click)="sort('status')" class="sortable">
                  Status
                  <i class="fas" [ngClass]="getSortIcon('status')"></i>
                </th>
                <th>Building</th>
                <th (click)="sort('capacity')" class="sortable">
                  Capacity
                  <i class="fas" [ngClass]="getSortIcon('capacity')"></i>
                </th>
                <th (click)="sort('pricePerNight')" class="sortable">
                  Price/Night
                  <i class="fas" [ngClass]="getSortIcon('pricePerNight')"></i>
                </th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let room of rooms; trackBy: trackByRoomId">
                <td>
                  <input
                    type="checkbox"
                    class="form-check-input"
                    [checked]="isRoomSelected(room.id)"
                    (change)="toggleRoomSelection(room.id)"
                  />
                </td>
                <td>
                  <strong>{{ room.roomNumber }}</strong>
                </td>
                <td>{{ getRoomTypeLabel(room.roomType) }}</td>
                <td>
                  <span
                    class="badge"
                    [ngClass]="'badge-' + getStatusClass(room.status)"
                  >
                    {{ getStatusLabel(room.status) }}
                  </span>
                </td>
                <td>{{ room.building }}</td>
                <td>{{ room.capacity }}</td>
                <td>{{ room.pricePerNight | currency }}</td>
                <td>
                  <div class="btn-group btn-group-sm">
                    <button
                      class="btn btn-outline-primary"
                      (click)="viewRoom(room.id)"
                    >
                      <i class="fas fa-eye"></i>
                    </button>
                    <button
                      class="btn btn-outline-secondary"
                      (click)="editRoom(room.id)"
                    >
                      <i class="fas fa-edit"></i>
                    </button>
                    <button
                      class="btn btn-outline-danger"
                      (click)="deleteRoom(room.id)"
                    >
                      <i class="fas fa-trash"></i>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Pagination -->
      <div class="pagination-wrapper" *ngIf="totalPages > 1">
        <div class="pagination-controls"></div>

        <div class="pagination-main">
          <nav aria-label="Room pagination">
            <ul class="pagination">
              <!-- First Page Button -->
              <li class="page-item" [class.disabled]="isFirst">
                <button
                  class="page-link"
                  (click)="goToPage(0)"
                  [disabled]="isFirst"
                >
                  First
                </button>
              </li>
              <!-- Previous Button -->
              <li class="page-item" [class.disabled]="isFirst">
                <button
                  class="page-link"
                  (click)="goToPage(currentPage - 1)"
                  [disabled]="isFirst"
                >
                  Previous
                </button>
              </li>
              <!-- Page Numbers -->
              <li
                class="page-item"
                *ngFor="
                  let page of getVisiblePages();
                  trackBy: trackByPageNumber
                "
                [class.active]="page === currentPage"
              >
                <button class="page-link" (click)="goToPage(page)">
                  {{ page + 1 }}
                </button>
              </li>
              <!-- Next Button -->
              <li class="page-item" [class.disabled]="isLast">
                <button
                  class="page-link"
                  (click)="goToPage(currentPage + 1)"
                  [disabled]="isLast"
                >
                  Next
                </button>
              </li>
              <!-- Last Page Button -->
              <li class="page-item" [class.disabled]="isLast">
                <button
                  class="page-link"
                  (click)="goToPage(totalPages - 1)"
                  [disabled]="isLast"
                >
                  Last
                </button>
              </li>
            </ul>
          </nav>

          <div class="page-size-selector">
            <label class="form-label">Items per page:</label>
            <select
              class="form-select"
              [(ngModel)]="pageSize"
              (change)="onPageSizeChange()"
            >
              <option value="5">5</option>
              <option value="10">10</option>
              <option value="12">12</option>
              <option value="20">20</option>
              <option value="23">23</option>
              <option value="50">50</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty States -->
    <div
      class="empty-state"
      *ngIf="numberOfElements === 0 && totalElements > 0"
    >
      <i class="fas fa-search empty-state-icon"></i>
      <h3 class="empty-state-title">No rooms found</h3>
      <p class="empty-state-description">
        No rooms match your current search criteria.
      </p>
      <button class="btn btn-outline-primary" (click)="clearFilters()">
        Clear Filters
      </button>
    </div>

    <div class="empty-state" *ngIf="totalElements === 0 && !loading">
      <i class="fas fa-bed empty-state-icon"></i>
      <h3 class="empty-state-title">No rooms available</h3>
      <p class="empty-state-description">
        Start by adding your first room to the system.
      </p>
      <button class="btn btn-primary" (click)="addRoom()">
        Add First Room
      </button>
    </div>
  </div>
</div>
