<!-- src/app/modules/tv-channels/components/tv-channels-list/tv-channels-list.component.html -->
<div class="channel-list-container">
  <div class="page-header">
    <div class="page-header-content">
      <h1 class="page-title">TV Channels Management</h1>
      <p class="page-subtitle">Manage and configure television channels</p>
    </div>
    <div class="page-actions">
      <button 
        class="btn btn-secondary" 
        (click)="refreshChannels()" 
        [disabled]="loading$ | async">
        <i class="fas" 
           [class.fa-sync-alt]="!(loading$ | async)" 
           [class.fa-spinner]="loading$ | async" 
           [class.fa-spin]="loading$ | async"></i>
        {{ (loading$ | async) ? 'Loading...' : 'Refresh' }}
      </button>
      <button class="btn btn-primary btn-lg" (click)="addChannel()">
        <i class="fas fa-plus"></i>
        Add Channel
      </button>
    </div>
  </div>

  <!-- Error Display -->
  <div *ngIf="error" class="alert alert-error" style="margin-bottom: 24px;">
    <i class="fas fa-exclamation-triangle"></i>
    <span>{{ error }}</span>
    <button class="btn btn-sm btn-secondary" (click)="refreshChannels()">
      <i class="fas fa-redo"></i>
      Retry
    </button>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="filters-row">
      <div class="search-group">
        <div class="search-input-container">
          <i class="fas fa-search search-icon"></i>
          <input
            type="text"
            [value]="searchTerm"
            (input)="onSearchChange($any($event.target).value)"
            placeholder="Search channels by name, number, IP..."
            class="search-input"
          />
        </div>
      </div>

      <div class="filter-group">
        <select
          [(ngModel)]="selectedCategoryId"
          (change)="onFilterChange()"
          class="filter-select">
          <option [value]="null">All Categories</option>
          <option *ngFor="let category of categories" [value]="category.id">
            {{ category.name }}
          </option>
        </select>

        <select
          [(ngModel)]="selectedLanguageId"
          (change)="onFilterChange()"
          class="filter-select">
          <option [value]="null">All Languages</option>
          <option *ngFor="let language of languages" [value]="language.id">
            {{ language.name }} ({{ language.code }})
          </option>
        </select>

        <button class="btn btn-secondary" (click)="clearFilters()">
          <i class="fas fa-times"></i>
          Clear
        </button>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div *ngIf="loading$ | async" class="loading-overlay">
    <div class="loading-spinner">
      <i class="fas fa-spinner fa-spin"></i>
      <p>Loading channels...</p>
    </div>
  </div>

  <!-- Channels Table -->
  <div class="table-container" *ngIf="!(loading$ | async)">
    <div class="table-header">
      <h3 class="table-title">Channels ({{ totalElements }})</h3>
      <div class="table-actions">
        <button class="btn btn-secondary btn-sm" (click)="exportChannels()">
          <i class="fas fa-download"></i>
          Export
        </button>
      </div>
    </div>

    <div class="table-content">
      <table class="table" *ngIf="channels.length > 0">
        <thead>
          <tr>
            <th>
              <button class="sort-btn" (click)="onSortChange('channelNumber')">
                Channel #
                <i class="fas fa-sort" 
                   [class.fa-sort-up]="sortBy === 'channelNumber' && sortDirection === 'asc'"
                   [class.fa-sort-down]="sortBy === 'channelNumber' && sortDirection === 'desc'"></i>
              </button>
            </th>
            <th>
              <button class="sort-btn" (click)="onSortChange('name')">
                Name
                <i class="fas fa-sort" 
                   [class.fa-sort-up]="sortBy === 'name' && sortDirection === 'asc'"
                   [class.fa-sort-down]="sortBy === 'name' && sortDirection === 'desc'"></i>
              </button>
            </th>
            <th>Category</th>
            <th>Language</th>
            <th>Network</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let channel of channels" class="table-row">
            <td>
              <div class="channel-number">
                <strong>{{ channel.channelNumber }}</strong>
              </div>
            </td>
            <td>
              <div class="channel-info">
                <div class="channel-name">
                  <img *ngIf="channel.logoUrl" 
                       [src]="channel.logoUrl" 
                       [alt]="channel.name"
                       class="channel-logo">
                  <span>{{ channel.name }}</span>
                </div>
                <div class="channel-description" *ngIf="channel.description">
                  {{ channel.description }}
                </div>
              </div>
            </td>
            <td>
              <span *ngIf="channel.category" class="status-badge status-info">
                {{ channel.category.name }}
              </span>
              <span *ngIf="!channel.category" class="text-secondary">
                No category
              </span>
            </td>
            <td>
              <span *ngIf="channel.language" class="status-badge status-secondary">
                {{ channel.language.name }} ({{ channel.language.code }})
              </span>
              <span *ngIf="!channel.language" class="text-secondary">
                No language
              </span>
            </td>
            <td>
              <div class="network-info">
                <div class="ip-port">
                  <i class="fas fa-globe"></i>
                  {{ channel.ip }}:{{ channel.port }}
                </div>
              </div>
            </td>
            <td>
              <span class="status-badge" 
                    [class]="'status-' + getStatusClass(getChannelStatus(channel))">
                {{ getChannelStatus(channel) | titlecase }}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <button
                  class="btn btn-sm btn-secondary action-btn"
                  (click)="viewChannel(channel.id)"
                  title="View Details">
                  <i class="fas fa-eye"></i>
                </button>
                <button
                  class="btn btn-sm btn-primary action-btn"
                  (click)="editChannel(channel.id)"
                  title="Edit Channel">
                  <i class="fas fa-edit"></i>
                </button>
                <button
                  class="btn btn-sm btn-danger action-btn"
                  (click)="deleteChannel(channel.id)"
                  title="Delete Channel">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Empty State -->
      <div *ngIf="channels.length === 0 && !(loading$ | async)" class="empty-state">
        <div class="empty-state-content">
          <i class="fas fa-tv empty-state-icon"></i>
          <h3 class="empty-state-title">No channels found</h3>
          <p class="empty-state-description">
            {{ error ? 'There was an error loading channels.' : 
               (searchTerm || selectedCategoryId || selectedLanguageId ? 
                'No channels match your current search criteria.' : 
                'No channels have been configured yet.') }}
          </p>
          <div class="empty-state-actions">
            <button *ngIf="searchTerm || selectedCategoryId || selectedLanguageId" 
                    class="btn btn-secondary" 
                    (click)="clearFilters()">
              <i class="fas fa-times"></i>
              Clear Filters
            </button>
            <button class="btn btn-primary" (click)="addChannel()">
              <i class="fas fa-plus"></i>
              Add Channel
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div class="pagination-container" *ngIf="totalPages > 1 && !(loading$ | async)">
    <div class="pagination-info">
      Showing {{ (currentPage * pageSize) + 1 }} to 
      {{ Math.min((currentPage + 1) * pageSize, totalElements) }} 
      of {{ totalElements }} channels
    </div>
    
    <div class="pagination-controls">
      <button 
        class="btn btn-sm btn-secondary" 
        [disabled]="currentPage === 0" 
        (click)="onPageChange(currentPage - 1)">
        <i class="fas fa-chevron-left"></i>
        Previous
      </button>
      
      <div class="page-numbers">
        <button 
          *ngFor="let page of getPageNumbers()" 
          class="btn btn-sm" 
          [class.btn-primary]="page === currentPage"
          [class.btn-secondary]="page !== currentPage"
          (click)="onPageChange(page)">
          {{ page + 1 }}
        </button>
      </div>
      
      <button 
        class="btn btn-sm btn-secondary" 
        [disabled]="currentPage === totalPages - 1" 
        (click)="onPageChange(currentPage + 1)">
        Next
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </div>
</div>